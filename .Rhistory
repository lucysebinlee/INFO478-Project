dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_ht) [1] = "Hypertension"
names(lbw_ht) [2] = "Hypertension/Total"
names(lbw_ht) [3] = "No Hypertension"
names(lbw_ht) [4] = "No Hypertension/Total"
names(lbw_ht) [5] = "Risk Ratio"
rownames(lbw_ht) [1] = "No Low Birth Weight"
rownames(lbw_ht) [2] = "Birth Weight"
lbw_ftv <- data.frame(lbw_ftv) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_ftv) [1] = "Prenatal Care Visit"
names(lbw_ftv) [2] = "Prenatal Care Visit/Total"
names(lbw_ftv) [3] = "No Prenatal Care Visit"
names(lbw_ftv) [4] = "No Prenatal Care Visit/Total"
names(lbw_ftv) [5] = "Risk Ratio"
rownames(lbw_ftv) [1] = "No Low Birth Weight"
rownames(lbw_ftv) [2] = "Birth Weight"
lbw_age <- data.frame(lbw_age) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_age) [1] = "Age Below 20"
names(lbw_age) [2] = "Age Below 20/Total"
names(lbw_age) [3] = "Not Age Below 20"
names(lbw_age) [4] = "Not Age Below 20/Total"
names(lbw_age) [5] = "Risk Ratio"
rownames(lbw_age) [1] = "No Low Birth Weight"
rownames(lbw_age) [2] = "Birth Weight"
# Endometrial Cancer ---------------------------------------------------------------------
data(bdendo) # Load Bdendo Data for Endometrial Cancer
# Calculation of Hypertension vs. Endometrial Cancer
endo_hyp <- epitab(bdendo$d, bdendo$hyp, method = "oddsratio")
endo_hyp <- data.frame(endo_hyp) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_hyp) [1] = "Hypertension"
names(endo_hyp) [2] = "No Hypertension"
names(endo_hyp) [3] = "Odds Ratio"
rownames(endo_hyp) [1] = "No Endometrial Cancer"
rownames(endo_hyp) [2] = "Endometrial Cancer"
# Calculation of Gall Bladder Disease vs. Endometrial Cancer
endo_gall <- epitab(bdendo$d, bdendo$gall, method = "oddsratio")
endo_gall <- data.frame(endo_gall) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_gall) [1] = "Gall Bladder"
names(endo_gall) [2] = "No Gall Bladder"
names(endo_gall) [3] = "Odds Ratio"
rownames(endo_gall) [1] = "No Endometrial Cancer"
rownames(endo_gall) [2] = "Endometrial Cancer"
# Calculation of Obesity vs. Endometrial Cancer
endo_ob <- epitab(bdendo$d, bdendo$ob, method = "oddsratio")
endo_ob <- data.frame(endo_ob) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_ob) [1] = "Obesity"
names(endo_ob) [2] = "No Obesity"
names(endo_ob) [3] = "Odds Ratio"
rownames(endo_ob) [1] = "No Endometrial Cancer"
rownames(endo_ob) [2] = "Endometrial Cancer"
lbw_smoke <- epitab(lbw_data_3$low, lbw_data_3$smoke, method = "riskratio")
lbw_ht <- epitab(lbw_data_3$low, lbw_data_3$ht, method = "riskratio")
lbw_ftv <- epitab(lbw_data_3$low, lbw_data_3$ftv, method = "riskratio")
lbw_age <- epitab(lbw_data_3$low, lbw_data_3$age, method = "riskratio")
lbw_data_3 <- lbw_data_3 %>%
mutate(age = ifelse(age < 20, 1, 0)) #
# Computes Question 3 of Low Birth Weight
lbw_smoke <- epitab(lbw_data_3$low, lbw_data_3$smoke, method = "riskratio")
lbw_ht <- epitab(lbw_data_3$low, lbw_data_3$ht, method = "riskratio")
lbw_ftv <- epitab(lbw_data_3$low, lbw_data_3$ftv, method = "riskratio")
lbw_age <- epitab(lbw_data_3$low, lbw_data_3$age, method = "riskratio")
lbw_smoke <- data.frame(lbw_smoke) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_smoke) [1] = "Smoke"
names(lbw_smoke) [2] = "Smoke/Total"
names(lbw_smoke) [3] = "No Smoke"
names(lbw_smoke) [4] = "No Smoke/Total"
names(lbw_smoke) [5] = "Risk Ratio"
rownames(lbw_smoke) [1] = "No Low Birth Weight"
rownames(lbw_smoke) [2] = "Birth Weight"
lbw_ht <- data.frame(lbw_ht) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_ht) [1] = "Hypertension"
names(lbw_ht) [2] = "Hypertension/Total"
names(lbw_ht) [3] = "No Hypertension"
names(lbw_ht) [4] = "No Hypertension/Total"
names(lbw_ht) [5] = "Risk Ratio"
rownames(lbw_ht) [1] = "No Low Birth Weight"
rownames(lbw_ht) [2] = "Birth Weight"
lbw_ftv <- data.frame(lbw_ftv) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_ftv) [1] = "Prenatal Care Visit"
names(lbw_ftv) [2] = "Prenatal Care Visit/Total"
names(lbw_ftv) [3] = "No Prenatal Care Visit"
names(lbw_ftv) [4] = "No Prenatal Care Visit/Total"
names(lbw_ftv) [5] = "Risk Ratio"
rownames(lbw_ftv) [1] = "No Low Birth Weight"
rownames(lbw_ftv) [2] = "Birth Weight"
lbw_age <- data.frame(lbw_age) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_age) [1] = "Age Below 20"
names(lbw_age) [2] = "Age Below 20/Total"
names(lbw_age) [3] = "Not Age Below 20"
names(lbw_age) [4] = "Not Age Below 20/Total"
names(lbw_age) [5] = "Risk Ratio"
rownames(lbw_age) [1] = "No Low Birth Weight"
rownames(lbw_age) [2] = "Birth Weight"
# Endometrial Cancer ---------------------------------------------------------------------
data(bdendo) # Load Bdendo Data for Endometrial Cancer
# Calculation of Hypertension vs. Endometrial Cancer
endo_hyp <- epitab(bdendo$d, bdendo$hyp, method = "oddsratio")
endo_hyp <- data.frame(endo_hyp) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_hyp) [1] = "Hypertension"
names(endo_hyp) [2] = "No Hypertension"
names(endo_hyp) [3] = "Odds Ratio"
rownames(endo_hyp) [1] = "No Endometrial Cancer"
rownames(endo_hyp) [2] = "Endometrial Cancer"
# Calculation of Gall Bladder Disease vs. Endometrial Cancer
endo_gall <- epitab(bdendo$d, bdendo$gall, method = "oddsratio")
endo_gall <- data.frame(endo_gall) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_gall) [1] = "Gall Bladder"
names(endo_gall) [2] = "No Gall Bladder"
names(endo_gall) [3] = "Odds Ratio"
rownames(endo_gall) [1] = "No Endometrial Cancer"
rownames(endo_gall) [2] = "Endometrial Cancer"
# Calculation of Obesity vs. Endometrial Cancer
endo_ob <- epitab(bdendo$d, bdendo$ob, method = "oddsratio")
endo_ob <- data.frame(endo_ob) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_ob) [1] = "Obesity"
names(endo_ob) [2] = "No Obesity"
names(endo_ob) [3] = "Odds Ratio"
rownames(endo_ob) [1] = "No Endometrial Cancer"
rownames(endo_ob) [2] = "Endometrial Cancer"
endo_hyp <- epitab(bdendo$d, bdendo$hyp, method = "oddsratio")
endo_hyp <- data.frame(endo_hyp) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_hyp) [1] = "Hypertension"
names(endo_hyp) [2] = "No Hypertension"
names(endo_hyp) [3] = "Odds Ratio"
rownames(endo_hyp) [1] = "No Endometrial Cancer"
rownames(endo_hyp) [2] = "Endometrial Cancer"
# Calculation of Gall Bladder Disease vs. Endometrial Cancer
endo_gall <- epitab(bdendo$d, bdendo$gall, method = "oddsratio")
endo_gall <- data.frame(endo_gall) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_gall) [1] = "Gall Bladder"
names(endo_gall) [2] = "No Gall Bladder"
names(endo_gall) [3] = "Odds Ratio"
rownames(endo_gall) [1] = "No Endometrial Cancer"
rownames(endo_gall) [2] = "Endometrial Cancer"
# Calculation of Obesity vs. Endometrial Cancer
endo_ob <- epitab(bdendo$d, bdendo$ob, method = "oddsratio")
endo_ob <- data.frame(endo_ob) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_ob) [1] = "Obesity"
names(endo_ob) [2] = "No Obesity"
names(endo_ob) [3] = "Odds Ratio"
rownames(endo_ob) [1] = "No Endometrial Cancer"
rownames(endo_ob) [2] = "Endometrial Cancer"
DT::datatable(head(endo_hyp), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(endo_gall), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(endo_ob), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(lbw_smoke), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(lbw_ht), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(lbw_ftv), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(lbw_age), options = list(dom = 't', rownames = FALSE))
bdendo <- bdendo %>%
mutate_if(is.numeric, round, digits = 2)
endo_hyp <- epitab(bdendo$d, bdendo$hyp, method = "oddsratio")
endo_hyp <- data.frame(endo_hyp) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_hyp) [1] = "Hypertension"
names(endo_hyp) [2] = "No Hypertension"
names(endo_hyp) [3] = "Odds Ratio"
rownames(endo_hyp) [1] = "No Endometrial Cancer"
rownames(endo_hyp) [2] = "Endometrial Cancer"
# Calculation of Gall Bladder Disease vs. Endometrial Cancer
endo_gall <- epitab(bdendo$d, bdendo$gall, method = "oddsratio")
endo_gall <- data.frame(endo_gall) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_gall) [1] = "Gall Bladder"
names(endo_gall) [2] = "No Gall Bladder"
names(endo_gall) [3] = "Odds Ratio"
rownames(endo_gall) [1] = "No Endometrial Cancer"
rownames(endo_gall) [2] = "Endometrial Cancer"
# Calculation of Obesity vs. Endometrial Cancer
endo_ob <- epitab(bdendo$d, bdendo$ob, method = "oddsratio")
endo_ob <- data.frame(endo_ob) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_ob) [1] = "Obesity"
names(endo_ob) [2] = "No Obesity"
names(endo_ob) [3] = "Odds Ratio"
rownames(endo_ob) [1] = "No Endometrial Cancer"
rownames(endo_ob) [2] = "Endometrial Cancer"
DT::datatable(head(lbw_smoke), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(lbw_ht), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(lbw_ftv), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(lbw_age), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(endo_hyp), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(endo_gall), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(endo_ob), options = list(dom = 't', rownames = FALSE))
endo_hyp <- epitab(bdendo$d, bdendo$hyp, method = "oddsratio")
endo_hyp <- data.frame(endo_hyp) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio) %>%
mutate_if(is.numeric(tab.oddsratio), round, digits = 2)
data(bdendo)
endo_hyp <- epitab(bdendo$d, bdendo$hyp, method = "oddsratio")
endo_hyp <- data.frame(endo_hyp) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio) %>%
mutate_if(is.numeric(endo_hyp$tab.oddsratio), round, digits = 2)
endo_hyp <- epitab(bdendo$d, bdendo$hyp, method = "oddsratio")
endo_hyp <- data.frame(endo_hyp) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio) %>%
mutate_if(is.numeric(tab.oddsratio), round, digits = 2)
endo_hyp <- epitab(bdendo$d, bdendo$hyp, method = "oddsratio")
endo_hyp <- data.frame(endo_hyp) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio) %>%
mutate_if(is.numeric(endo_hyp$tab.oddsratio), round, digits = 2)
endo_hyp <- epitab(bdendo$d, bdendo$hyp, method = "oddsratio")
endo_hyp <- data.frame(endo_hyp) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio) %>%
mutate_if(endo_hyp, is.numeric(tab.oddsratio), round, digits = 2)
lbw_data_3 <- lbw_data_3 %>%
mutate(age = ifelse(age < 20, 1, 0)) %>% # Change to 1 if Gave Birth Before 20
mutate_if(is.numeric, round, digits = 2)
lbw_smoke <- epitab(lbw_data_3$low, lbw_data_3$smoke, method = "riskratio")
lbw_ht <- epitab(lbw_data_3$low, lbw_data_3$ht, method = "riskratio")
lbw_ftv <- epitab(lbw_data_3$low, lbw_data_3$ftv, method = "riskratio")
lbw_age <- epitab(lbw_data_3$low, lbw_data_3$age, method = "riskratio")
lbw_data_3 <- lbw_data_3 %>%
mutate(age = ifelse(age < 20, 1, 0)) # Change to 1 if Gave Birth Before 20
lbw_smoke <- epitab(lbw_data_3$low, lbw_data_3$smoke, method = "riskratio")
lbw_ht <- epitab(lbw_data_3$low, lbw_data_3$ht, method = "riskratio")
lbw_ftv <- epitab(lbw_data_3$low, lbw_data_3$ftv, method = "riskratio")
lbw_age <- epitab(lbw_data_3$low, lbw_data_3$age, method = "riskratio")
lbw_smoke <- data.frame(lbw_smoke) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_smoke) [1] = "Smoke"
names(lbw_smoke) [2] = "Smoke/Total"
names(lbw_smoke) [3] = "No Smoke"
names(lbw_smoke) [4] = "No Smoke/Total"
names(lbw_smoke) [5] = "Risk Ratio"
rownames(lbw_smoke) [1] = "No Low Birth Weight"
rownames(lbw_smoke) [2] = "Birth Weight"
lbw_ht <- data.frame(lbw_ht) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_ht) [1] = "Hypertension"
names(lbw_ht) [2] = "Hypertension/Total"
names(lbw_ht) [3] = "No Hypertension"
names(lbw_ht) [4] = "No Hypertension/Total"
names(lbw_ht) [5] = "Risk Ratio"
rownames(lbw_ht) [1] = "No Low Birth Weight"
rownames(lbw_ht) [2] = "Birth Weight"
lbw_ftv <- data.frame(lbw_ftv) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_ftv) [1] = "Prenatal Care Visit"
names(lbw_ftv) [2] = "Prenatal Care Visit/Total"
names(lbw_ftv) [3] = "No Prenatal Care Visit"
names(lbw_ftv) [4] = "No Prenatal Care Visit/Total"
names(lbw_ftv) [5] = "Risk Ratio"
rownames(lbw_ftv) [1] = "No Low Birth Weight"
rownames(lbw_ftv) [2] = "Birth Weight"
lbw_age <- data.frame(lbw_age) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_age) [1] = "Age Below 20"
names(lbw_age) [2] = "Age Below 20/Total"
names(lbw_age) [3] = "Not Age Below 20"
names(lbw_age) [4] = "Not Age Below 20/Total"
names(lbw_age) [5] = "Risk Ratio"
rownames(lbw_age) [1] = "No Low Birth Weight"
rownames(lbw_age) [2] = "Birth Weight"
DT::datatable(head(endo_hyp), options = list(dom = 't', rownames = FALSE))
DT::datatable(head(lbw_smoke), options = list(dom = 't', rownames = FALSE))
source('./analysis.R')
library(dplyr)
library(ggplot2)
library(HSAUR)
library(MASS)
library(Epi)
library(epitools)
library(summarytools)
library(knitr)
library(DT)
# Load Packages
library(dplyr)
library(ggplot2)
library(HSAUR)
library(MASS)
library(Epi)
library(epitools)
library(summarytools)
library(knitr)
library(DT)
# Tuberculosis ---------------------------------------------------------------------------
tuberculosis_data <- data.frame(HSAUR::BCG) %>%
mutate(BCGNoTB = BCGVacc - BCGTB) %>%
mutate(NoVaccNoTB = NoVacc - NoVaccTB) %>%
# Calculate the Odds Ratio (Question 1)
mutate(OddsBCGTB = BCGTB / NoVaccTB) %>%
mutate(OddsBCGNoTB = BCGNoTB / NoVaccNoTB) %>%
mutate(OddsRatio = OddsBCGTB / OddsBCGNoTB) %>%
# Calculate the Risks Ratio (Question 4)
mutate(RiskBCGTB = BCGTB / BCGVacc) %>%
mutate(RiskNoVacc = NoVaccTB / NoVacc) %>%
mutate(RiskRatio = RiskBCGTB / RiskNoVacc)
# Round Data to Two Decimal Points
tuberculosis_data <- tuberculosis_data %>%
mutate_if(is.numeric, round, digits = 2)
OddsRatioAverage = (sum(tuberculosis_data$OddsRatio) / nrow(tuberculosis_data)) # 0.5823
# Computes Question 1 of Tuberculosis
tuberculosis_plot_1 <- ggplot(tuberculosis_data, aes(x = Study, y = OddsRatio)) +
geom_bar(aes(color = OddsRatio), stat = "identity", fill = "white") +
theme_minimal() +
scale_x_continuous(breaks = tuberculosis_data$Study) +
labs(title = "Odds Ratio of BCG Vaccine with Tuberculosis") + ylab("Odds Ratio")
# Computes Question 2-1 of Tuberculosis
tuberculosis_data$Year <- as.factor(tuberculosis_data$Year)
tuberculosis_plot_2 <- ggplot(tuberculosis_data, aes(x = Year, y = OddsRatio)) +
geom_bar(aes(color = OddsRatio), stat = "identity", fill = "white") +
theme_minimal() +
labs(title = "Odds Ratio of Study by Year") + ylab("Odds Ratio")
# Computes Question 2-2 of Tuberculosis
tuberculosis_data$Latitude <- as.factor(tuberculosis_data$Latitude)
tuberculosis_plot_3 <- ggplot(tuberculosis_data, aes(x = Latitude, y = OddsRatio)) +
geom_bar(aes(color = OddsRatio), stat = "identity", fill = "white") +
theme_minimal() +
labs(title = "Odds Ratio of Study by Latitude") + ylab("Odds Ratio")
# Computes Question 4 of Tuberculosis (Compare Odds Ratio vs. Risks Ratio)
tuberculosis_ratio <- ggplot(tuberculosis_data, aes(x = OddsRatio, y = RiskRatio, color = RiskRatio)) +
geom_point(size = 3) +
geom_smooth(method = lm, se = FALSE, fullrange = TRUE) +
theme_minimal() +
labs(title = "Comparison between Odds Ratio and Risks Ratio") +
xlab("Odds Ratio") + ylab("Risk Ratio")
# Low Birth Weight -----------------------------------------------------------------------
lbw_data <- data.frame(MASS::birthwt)
lbw_data_2 <- data.frame(MASS::birthwt) # Use for Question 1
lbw_data_3 <- data.frame(MASS::birthwt) # Use for Question 3
lbw_data$race <- as.factor(lbw_data$race)
lbw_data$smoke <- as.factor(lbw_data$smoke)
lbw_data$ui <- as.factor(lbw_data$ui)
lbw_data$low <- as.factor(lbw_data$low)
lbw_data$ht <- as.factor(lbw_data$ht)
# Reorganizing the Basic Dataset
lbw_data <- lbw_data %>%
mutate(race = ifelse(race == 1, "White", "Non-White")) %>%
mutate(smoke = ifelse(smoke == 1, "Yes", "No")) %>%
mutate(ui = ifelse(ui == 1, "Yes", "No")) %>%
mutate(low = ifelse(low == 1, "Yes", "No")) %>%
mutate(ht = ifelse(ht == 1, "Yes", "No"))
names(lbw_data) [1] = "Birth Weight Less than 2.5 Kg"
names(lbw_data) [2] = "Mother's Age"
names(lbw_data) [3] = "Mother's Weight at Last Menstrual Period in Lbs"
names(lbw_data) [4] = "Mother's Race"
names(lbw_data) [5] = "Smoking Status during Pregnancy"
names(lbw_data) [6] = "Num of Previous Premature Labours"
names(lbw_data) [7] = "Hypertension"
names(lbw_data) [8] = "Uterine Irritability"
names(lbw_data) [9] = "Num of Physician Visits during First Trim"
names(lbw_data) [10] = "Birth Weight in Grams"
# Computes Question 1 of Low Birth Weight
low_proportion <- (sum(lbw_data_2$low) / nrow(lbw_data_2)) # 59 out of 189 Are Low Birth Weights
smoke_proportion <- (sum(lbw_data_2$smoke) / nrow(lbw_data_2)) # 74 out of 189 Are Smokers
bwt_mean <- (sum(lbw_data_2$bwt) / nrow(lbw_data_2)) # Average Birth Weight is 2944.587 grams
age_mean <- (sum(lbw_data_2$age) / nrow(lbw_data_2)) # Average Mother's Age in Years
lwt_mean <- (sum(lbw_data_2$lwt) / nrow(lbw_data_2)) # Average Mother's Weight at Last Menstrual Peroiod
lbw_df <- data.frame(low_proportion, smoke_proportion, bwt_mean, age_mean, lwt_mean)
names(lbw_df) [1] = "Low Birth Weight Proportion"
names(lbw_df) [2] = "Smoking Proportion"
names(lbw_df) [3] = "Average Birth Weight in Grams"
names(lbw_df) [4] = "Average Mother's Age"
names(lbw_df) [5] = "Average Mother's Weight at Last Menstrual Period in Lbs"
# Round Data to Two Decimal Points
lbw_df <- lbw_df %>%
mutate_if(is.numeric, round, digits = 2)
# Computes Question 2 of Low Birth Weight
lbw_data_3 <- lbw_data_3 %>%
mutate(age = ifelse(age < 20, 1, 0)) # Change to 1 if Gave Birth Before 20
# lbw_function <- function(dataset, col_name) {
#   group_by(col_name) %>%
#   summarize(sum = sum(col_name), total = nrow(col_name)) %>%
#   mutate(proportion = sum / total)
# return(dataset$proportion)
# }
# lbw_function <- function(dataset, col_name) {
#   data <- epitab(dataset$low, dataset$col_name, method = "riskratio")
# return(data$tab)
# }
# lbw_smoke <- lbw_function(lbw_data_3, "smoke")
# lbw_ht <- lbw_function(lbw_data_3, "ht")
# lbw_ftv <- lbw_function(lbw_data_3, "ftv")
# lbw_age <- lbw_function(lbw_data_3, "age")
# Computes Question 3 of Low Birth Weight
lbw_smoke <- epitab(lbw_data_3$low, lbw_data_3$smoke, method = "riskratio")
lbw_ht <- epitab(lbw_data_3$low, lbw_data_3$ht, method = "riskratio")
lbw_ftv <- epitab(lbw_data_3$low, lbw_data_3$ftv, method = "riskratio")
lbw_age <- epitab(lbw_data_3$low, lbw_data_3$age, method = "riskratio")
lbw_smoke <- data.frame(lbw_smoke) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_smoke) [1] = "Smoke"
names(lbw_smoke) [2] = "Smoke/Total"
names(lbw_smoke) [3] = "No Smoke"
names(lbw_smoke) [4] = "No Smoke/Total"
names(lbw_smoke) [5] = "Risk Ratio"
rownames(lbw_smoke) [1] = "No Low Birth Weight"
rownames(lbw_smoke) [2] = "Birth Weight"
lbw_ht <- data.frame(lbw_ht) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_ht) [1] = "Hypertension"
names(lbw_ht) [2] = "Hypertension/Total"
names(lbw_ht) [3] = "No Hypertension"
names(lbw_ht) [4] = "No Hypertension/Total"
names(lbw_ht) [5] = "Risk Ratio"
rownames(lbw_ht) [1] = "No Low Birth Weight"
rownames(lbw_ht) [2] = "Birth Weight"
lbw_ftv <- data.frame(lbw_ftv) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_ftv) [1] = "Prenatal Care Visit"
names(lbw_ftv) [2] = "Prenatal Care Visit/Total"
names(lbw_ftv) [3] = "No Prenatal Care Visit"
names(lbw_ftv) [4] = "No Prenatal Care Visit/Total"
names(lbw_ftv) [5] = "Risk Ratio"
rownames(lbw_ftv) [1] = "No Low Birth Weight"
rownames(lbw_ftv) [2] = "Birth Weight"
lbw_age <- data.frame(lbw_age) %>%
dplyr::select(tab.0, tab.p0, tab.1, tab.p1, tab.riskratio)
names(lbw_age) [1] = "Age Below 20"
names(lbw_age) [2] = "Age Below 20/Total"
names(lbw_age) [3] = "Not Age Below 20"
names(lbw_age) [4] = "Not Age Below 20/Total"
names(lbw_age) [5] = "Risk Ratio"
rownames(lbw_age) [1] = "No Low Birth Weight"
rownames(lbw_age) [2] = "Birth Weight"
# Endometrial Cancer ---------------------------------------------------------------------
data(bdendo) # Load Bdendo Data for Endometrial Cancer
# Calculation of Hypertension vs. Endometrial Cancer
endo_hyp <- epitab(bdendo$d, bdendo$hyp, method = "oddsratio")
endo_hyp <- data.frame(endo_hyp) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_hyp) [1] = "Hypertension"
names(endo_hyp) [2] = "No Hypertension"
names(endo_hyp) [3] = "Odds Ratio"
rownames(endo_hyp) [1] = "No Endometrial Cancer"
rownames(endo_hyp) [2] = "Endometrial Cancer"
# Calculation of Gall Bladder Disease vs. Endometrial Cancer
endo_gall <- epitab(bdendo$d, bdendo$gall, method = "oddsratio")
endo_gall <- data.frame(endo_gall) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_gall) [1] = "Gall Bladder"
names(endo_gall) [2] = "No Gall Bladder"
names(endo_gall) [3] = "Odds Ratio"
rownames(endo_gall) [1] = "No Endometrial Cancer"
rownames(endo_gall) [2] = "Endometrial Cancer"
# Calculation of Obesity vs. Endometrial Cancer
endo_ob <- epitab(bdendo$d, bdendo$ob, method = "oddsratio")
endo_ob <- data.frame(endo_ob) %>%
dplyr::select(tab.No, tab.Yes, tab.oddsratio)
names(endo_ob) [1] = "Obesity"
names(endo_ob) [2] = "No Obesity"
names(endo_ob) [3] = "Odds Ratio"
rownames(endo_ob) [1] = "No Endometrial Cancer"
rownames(endo_ob) [2] = "Endometrial Cancer"
DT::datatable(head(lbw_smoke), options = list(dom = 't', rownames = FALSE),
caption = 'Table 1: Low Birth Weight vs. Smoking Status')
DT::datatable(head(lbw_ht), options = list(dom = 't', rownames = FALSE),
caption = 'Table 1: Low Birth Weight vs. Hypertension Status')
DT::datatable(head(lbw_ftv), options = list(dom = 't', rownames = FALSE),
caption = 'Table 1: Low Birth Weight vs. Attending Prenatal Care Visits')
DT::datatable(head(lbw_age), options = list(dom = 't', rownames = FALSE),
caption = 'Table 1: Low Birth Weight vs. Giving Birth Before Age 20')
lbw_smoke <- round_df(lbw_smoke, digits = 2)
round_df <- function(df, digits) {
nums <- vapply(df, is.numeric, FUN.VALUE = logical(1))
df[,nums] <- round(df[,nums], digits = digits)
(df)
}
lbw_smoke <- round_df(lbw_smoke, digits = 2)
View(lbw_smoke)
endo_gall <- round_df(endo_gall, digits = 2)endo_gall <- round_df(endo_gall, digits = 2)
endo_gall <- round_df(endo_gall, digits = 2)
endo_ob <- round_df(endo_ob, digits = 2)
endo_gall <- round_df(endo_gall, digits = 2)
endo_hyp <- round_df(endo_hyp, digits = 2)
lbw_age <- round_df(lbw_age, digits = 2)
lbw_ftv <- round_df(lbw_ftv, digits = 2)
lbw_ht <- round_df(lbw_ht, digits = 2)
lbw_function <- function(dataset, col_name) {
data <- epitab(dataset$low, dataset$col_name, method = "riskratio")
return(data$tab)
}
lbw_smoke <- lbw_function(lbw_data_3, "smoke")
lbw_function <- function(dataset, col_name) {
data <- epitab(dataset$low, dataset$col_name, method = "riskratio")
return(data.frame(data$tab))
}
lbw_smoke <- lbw_function(lbw_data_3, "smoke")
lbw_function <- function(dataset, col_name) {
group_by_(col_name) %>%
summarise_(sum = sum(low), total = n(col_name)) %>%
mutate(proportion = sum / total)
return(dataset$proportion)
}
lbw_smoke <- lbw_function(lbw_data_3, "smoke")
lbw_function <- function(dataset, col_name) {
group_by(col_name) %>%
summarise(sum = sum(low), total = n(col_name)) %>%
mutate(proportion = sum / total)
return(dataset$proportion)
}
lbw_smoke <- lbw_function(lbw_data_3, "smoke")
setwd("~/Desktop/Ongoing/INFO478-Project")
source('/student-merge.R')
source('data/student-merge.R')
source('data/student-merge.R')
